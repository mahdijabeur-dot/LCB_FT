<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fiche de Contr√¥le LCB-FT - Syst√®me de Gestion des Risques</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary-color: #1e3a8a;
            --secondary-color: #3b82f6;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --light-gray: #f3f4f6;
            --dark-gray: #6b7280;
            --white: #ffffff;
            --confidential: #d946ef;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }

        .confidential-banner {
            background-color: var(--confidential);
            color: white;
            text-align: center;
            padding: 0.5rem;
            font-weight: bold;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            letter-spacing: 1px;
        }

        header {
            background: linear-gradient(135deg, var(--primary-color), #0f172a);
            color: var(--white);
            padding: 1rem 2rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo h1 {
            font-size: 1.8rem;
            font-weight: 700;
        }

        .logo p {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .container {
            max-width: 1400px;
            margin: 1rem auto;
            padding: 0 2rem;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .card {
            background-color: var(--white);
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card h3 {
            font-size: 0.9rem;
            color: var(--dark-gray);
            margin-bottom: 0.5rem;
        }

        .card .value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .card .label {
            font-size: 0.85rem;
            color: var(--dark-gray);
        }

        .card.total { border-left: 4px solid var(--primary-color); }
        .card.critique { border-left: 4px solid var(--danger-color); }
        .card.majeur { border-left: 4px solid var(--warning-color); }
        .card.mineur { border-left: 4px solid var(--warning-color); }
        .card.conforme { border-left: 4px solid var(--success-color); }

        .section {
            background-color: var(--white);
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 1.5rem;
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid var(--secondary-color);
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--dark-gray);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--secondary-color);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-group.required label::after {
            content: " *";
            color: var(--danger-color);
        }

        .form-group.error input,
        .form-group.error select,
        .form-group.error textarea {
            border-color: var(--danger-color);
        }

        .form-group.error label {
            color: var(--danger-color);
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            justify-content: center;
        }

        .btn {
            padding: 0.75rem 2rem;
            border: none;
            border-radius: 5px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: var(--white);
        }

        .btn-primary:hover {
            background-color: #152e6d;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background-color: var(--light-gray);
            color: var(--dark-gray);
        }

        .btn-secondary:hover {
            background-color: #e5e7eb;
        }

        .btn-success {
            background-color: var(--success-color);
            color: var(--white);
        }

        .btn-success:hover {
            background-color: #0da271;
        }

        .btn-danger {
            background-color: var(--danger-color);
            color: var(--white);
        }

        .btn-danger:hover {
            background-color: #dc2626;
        }

        .btn-warning {
            background-color: var(--warning-color);
            color: var(--white);
        }

        .btn-warning:hover {
            background-color: #d97706;
        }

        .btn-sgiro {
            background-color: #0f172a;
            color: var(--white);
        }

        .btn-sgiro:hover {
            background-color: #1e293b;
        }

        .table-container {
            overflow-x: auto;
            margin-top: 1rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        table th,
        table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        table th {
            background-color: var(--primary-color);
            color: var(--white);
            font-weight: 600;
        }

        table tr:hover {
            background-color: var(--light-gray);
        }

        .btn-evaluer {
            padding: 0.25rem 0.75rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .btn-evaluer.conforme { background-color: #e6f7ed; color: #0d9488; }
        .btn-evaluer.mineur { background-color: #fff7e6; color: #d97706; }
        .btn-evaluer.majeur { background-color: #fff1e6; color: #ea580c; }
        .btn-evaluer.critique { background-color: #ffebee; color: #e53e3e; }
        .btn-evaluer.na { background-color: #f3f4f6; color: #6b7280; }

        .btn-evaluer:hover {
            transform: scale(1.05);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .chart-container {
            background-color: var(--white);
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
        }

        .chart-container h3 {
            font-size: 1.2rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
            text-align: center;
        }

        .chart-container canvas {
            max-height: 400px;
        }

        .stats-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .stats-table th,
        .stats-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .stats-table th {
            background-color: var(--primary-color);
            color: var(--white);
            font-weight: 600;
        }

        .stats-table tr:nth-child(even) {
            background-color: var(--light-gray);
        }

        .signature-area {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2rem;
            margin-top: 2rem;
        }

        .signature-box {
            text-align: center;
            padding: 1.5rem;
        }

        .signature-box hr {
            border: none;
            border-top: 1px solid #ddd;
            margin: 0.5rem 0;
        }

        .signature-box p {
            margin-top: 0.5rem;
            font-style: italic;
        }

        .footer {
            background-color: var(--primary-color);
            color: var(--white);
            text-align: center;
            padding: 2rem;
            margin-top: 3rem;
        }

        .footer p {
            margin: 0.5rem 0;
            font-size: 0.9rem;
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .status-conforme { background-color: #d1fae5; color: #0d9488; }
        .status-mineur { background-color: #fef3c7; color: #d97706; }
        .status-majeur { background-color: #fee2e2; color: #ef4444; }
        .status-critique { background-color: #fca5a5; color: #dc2626; }
        .status-na { background-color: #f3f4f6; color: #6b7280; }

        .sgiro-notification {
            display: none;
            background-color: #dbeafe;
            border-left: 4px solid #3b82f6;
            padding: 1rem;
            margin-top: 1rem;
            border-radius: 0 5px 5px 0;
        }

        .sgiro-notification.show {
            display: block;
        }

        .sgiro-notification p {
            margin-bottom: 0.5rem;
        }

        .sgiro-notification .close {
            float: right;
            cursor: pointer;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
            }

            .dashboard {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .signature-area {
                grid-template-columns: 1fr;
            }
        }

        .control-panel {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .export-controls {
            display: flex;
            gap: 1rem;
        }

        .sgiro-export {
            display: flex;
            gap: 0.5rem;
        }

        .sgiro-export button {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .sgiro-export button i {
            font-size: 1.2rem;
        }

        .sgiro-export .sgiro-status {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: #9ca3af;
        }

        .sgiro-export .sgiro-status.connected {
            background-color: #10b981;
        }

        .sgiro-export .sgiro-status.disconnected {
            background-color: #ef4444;
        }
        
        /* Nouveaux styles pour la gestion des contr√¥les sauvegard√©s */
        .controles-sauvegardes {
            margin-top: 2rem;
        }
        
        .controles-sauvegardes .control-panel {
            margin-bottom: 1rem;
        }
        
        .controles-sauvegardes .form-group {
            margin-bottom: 0;
        }
        
        .controles-sauvegardes table {
            margin-top: 0;
        }
        
        .controles-sauvegardes .btn-modifier {
            margin-right: 0.5rem;
        }
        
        .controles-sauvegardes .status-badge {
            min-width: 100px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="confidential-banner">
        Document confidentiel ‚Äì Archivage 10 ans (r√©f√©rentiel interne)
    </div>

    <header>
        <div class="header-content">
            <div class="logo">
                <h1>Fiche de Contr√¥le LCB-FT</h1>
                <div>
                
                    <p style="font-size: 0.8rem; margin-top: 0.25rem;">Direction du Contr√¥le Permanent </p>
                </div>
            </div>
            <div class="sgiro-export">
                <span class="sgiro-status connected" title="Connexion SGIRO"></span>
                <button class="btn btn-sgiro" id="btnExportSGIRO">
                    <i>üì§</i> Exporter vers SGIRO
                </button>
                <button class="btn btn-secondary" id="btnGenererRapport">
                    <i>üìä</i> G√©n√©rer Rapport
                </button>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="dashboard">
            <div class="card total">
                <h3>Points de Contr√¥le</h3>
                <div class="value" id="totalPoints">10</div>
                <div class="label">Total</div>
            </div>
            <div class="card conforme">
                <h3>Conformes</h3>
                <div class="value" id="conformes">0</div>
                <div class="label">Points conformes</div>
            </div>
            <div class="card mineur">
                <h3>Non Conformes</h3>
                <div class="value" id="ecartsMineurs">0</div>
                <div class="label">Points n√©cessitant une action</div>
            </div>
            <div class="card majeur">
                <h3>√âcarts Majeurs</h3>
                <div class="value" id="ecartsMajeurs">0</div>
                <div class="label">Points √† traiter en priorit√©</div>
            </div>
            <div class="card critique">
                <h3>√âcarts Critiques</h3>
                <div class="value" id="ecartsCritiques">0</div>
                <div class="label">Points √† traiter imm√©diatement</div>
            </div>
        </div>

        <section class="section">
            <div class="control-panel">
                <h2 class="section-title">Informations g√©n√©rales</h2>
                <div class="export-controls">
                    <button class="btn btn-secondary" id="btnReinitialiser">
                        <i>üîÑ</i> R√©initialiser
                    </button>
                    <button class="btn btn-secondary" id="btnImprimer">
                        <i>üñ®Ô∏è</i> Imprimer
                    </button>
                    <button class="btn btn-secondary" id="btnSauvegarder">
                        <i>üíæ</i> Sauvegarder
                    </button>
                </div>
            </div>
            
            <div class="form-grid">
                <div class="form-group required">
                    <label for="reference">N¬∞ R√©f√©rence</label>
                    <input type="text" id="reference" required placeholder="Ex: LCB-2026-001">
                </div>
                <div class="form-group required">
                    <label for="dateControle">Date du contr√¥le</label>
                    <input type="date" id="dateControle" required>
                </div>
                <div class="form-group required">
                    <label for="controleur">Contr√¥leur</label>
                    <input type="text" id="controleur" required placeholder="Nom et pr√©nom">
                </div>
                <div class="form-group required">
                    <label for="perimetre">P√©rim√®tre</label>
                    <select id="perimetre" multiple class="form-control" required>
                        <option value="ouverture_compte">Ouverture de Compte / MAJ KYC</option>
                        <option value="transactions">Transactions (Versements/Retraits/Virements/Change)</option>
                        <option value="monetique">Mon√©tique (Cartes / TPE)</option>
                        <option value="credits">Cr√©dits & Financements</option>
                        <option value="bancaire_etranger">Bancaire √âtranger / Correspondents & Change</option>
                        <option value="declarations_soupcon">D√©clarations de Soup√ßon</option>
                        <option value="gouvernance">Gouvernance & Fonction Conformit√©</option>
                    </select>
                    <small class="text-muted">S√©lectionnez plusieurs √©l√©ments en maintenant la touche Ctrl (ou Cmd sur Mac)</small>
                </div>
                <div class="form-group required">
                    <label for="entite">Entit√©(s) / Agence(s)</label>
                    <input type="text" id="entite" required placeholder="Entit√© ou agence (ex: Agence Tunis Centre)">
                </div>
                <div class="form-group required">
                    <label for="periodeControle">P√©riode contr√¥l√©e</label>
                    <input type="text" id="periodeControle" required placeholder="Ex: Janvier 2026">
                </div>
            </div>
        </section>

        <section class="section">
            <h2 class="section-title">Points de contr√¥le</h2>
            
            <div class="table-container">
                <table id="tableauControle">
                    <thead>
                        <tr>
                            <th>Point de contr√¥le</th>
                            <th>Niveau de Risque</th>
                            <th>Statut</th>
                            <th>√âvaluation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Les points de contr√¥le seront ajout√©s dynamiquement -->
                    </tbody>
                </table>
            </div>
        </section>

        <section class="section">
            <div class="control-panel">
                <h2 class="section-title">R√©sultats</h2>
                <div class="export-controls">
                    <button class="btn btn-success" id="btnGenererStatistiques">
                        <i>üìä</i> G√©n√©rer Statistiques
                    </button>
                </div>
            </div>
            
            <div class="stats-grid">
                <div class="chart-container">
                    <h3>R√©partition des R√©sultats</h3>
                    <canvas id="chartResultats"></canvas>
                </div>
                
                <div class="chart-container">
                    <h3>R√©partition par Niveau de Criticit√©</h3>
                    <canvas id="chartCriticite"></canvas>
                </div>
            </div>
            
            <div class="form-grid" style="margin-top: 2rem;">
                <div class="form-group">
                    <label for="conformesCount">Conformes</label>
                    <input type="number" id="conformesCount" readonly>
                </div>
                <div class="form-group">
                    <label for="ecartsMineursCount">Non Conformes</label>
                    <input type="number" id="ecartsMineursCount" readonly>
                </div>
                <div class="form-group">
                    <label for="ecartsMajeursCount">√âcarts Majeurs</label>
                    <input type="number" id="ecartsMajeursCount" readonly>
                </div>
                <div class="form-group">
                    <label for="ecartsCritiquesCount">√âcarts Critiques</label>
                    <input type="number" id="ecartsCritiquesCount" readonly>
                </div>
                <div class="form-group">
                    <label for="naCount">N/A</label>
                    <input type="number" id="naCount" readonly>
                </div>
                <div class="form-group">
                    <label for="objectifConformite">Objectif conformit√© (%)</label>
                    <input type="number" id="objectifConformite" min="0" max="100" value="95">
                </div>
            </div>
            
            <div class="form-group" style="margin-top: 1.5rem;">
                <label>Statut</label>
                <div class="status-badge" id="statutConformite">‚ö†Ô∏è √Ä am√©liorer</div>
            </div>
        </section>

        <section class="section">
            <h2 class="section-title">Analyse des √©carts</h2>
            
            <div class="form-grid">
                <div class="form-group">
                    <label for="constatsPrincipaux">Constats principaux</label>
                    <textarea id="constatsPrincipaux" placeholder="D√©taillez les principaux √©carts observ√©s..."></textarea>
                </div>
                <div class="form-group">
                    <label for="causesRacines">Causes racines</label>
                    <textarea id="causesRacines" placeholder="Analyse des causes profondes des √©carts..."></textarea>
                </div>
                <div class="form-group">
                    <label for="recommandationsCorrectives">Recommandations correctives</label>
                    <textarea id="recommandationsCorrectives" placeholder="Proposez des solutions pour corriger les √©carts..."></textarea>
                </div>
                <div class="form-group">
                    <label for="planActions">Plan d'actions (d√©lais & responsables)</label>
                    <textarea id="planActions" placeholder="D√©finissez un plan d'action avec d√©lais et responsables..."></textarea>
                </div>
            </div>
        </section>

        <section class="section">
            <h2 class="section-title">Signatures</h2>
            
            <div class="signature-area">
                <div class="signature-box">
                    <div class="signature" id="signatureControleur"></div>
                    <hr>
                    <p>Contr√¥leur</p>
                    <input type="text" id="nomControleur" placeholder="Nom et pr√©nom">
                    <div style="margin-top: 1rem;">Date : <input type="date" id="dateControleur"></div>
                </div>
                <div class="signature-box">
                    <div class="signature" id="signatureResponsable"></div>
                    <hr>
                    <p>Responsable Entit√©</p>
                    <input type="text" id="nomResponsable" placeholder="Nom et pr√©nom">
                    <div style="margin-top: 1rem;">Date : <input type="date" id="dateResponsable"></div>
                </div>
                <div class="signature-box">
                    <div class="signature" id="signatureRCLABC"></div>
                    <hr>
                    <p>RCLABC</p>
                    <input type="text" id="nomRCLABC" placeholder="Nom et pr√©nom">
                    <div style="margin-top: 1rem;">Date : <input type="date" id="dateRCLABC"></div>
                </div>
            </div>
        </section>

        <!-- Section des contr√¥les sauvegard√©s -->
        <section class="section controles-sauvegardes">
            <h2 class="section-title">Contr√¥les Sauvegard√©s</h2>
            
            <div class="control-panel">
                <div class="form-group" style="flex: 1;">
                    <label for="filtreControles">Filtrer les contr√¥les</label>
                    <select id="filtreControles" class="form-control">
                        <option value="all">Tous les contr√¥les</option>
                        <option value="conforme">Conformes</option>
                        <option value="mineur">√âcarts mineurs</option>
                        <option value="majeur">√âcarts majeurs</option>
                        <option value="critique">√âcarts critiques</option>
                    </select>
                </div>
                <div class="form-group" style="flex: 1;">
                    <label for="rechercheControles">Rechercher</label>
                    <input type="text" id="rechercheControles" placeholder="Rechercher par r√©f√©rence..." class="form-control">
                </div>
            </div>
            
            <div class="table-container">
                <table id="tableauControlesSauvegardes">
                    <thead>
                        <tr>
                            <th>R√©f√©rence</th>
                            <th>Date</th>
                            <th>Contr√¥leur</th>
                            <th>Conformit√©</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td colspan="5" class="text-center">Aucun contr√¥le sauvegard√©</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <div class="sgiro-notification" id="sgiroNotification">
            <span class="close" onclick="this.parentElement.classList.remove('show')">&times;</span>
            <p><strong>Export SGIRO r√©ussi !</strong></p>
            <p>Les √©carts critiques et majeurs ont √©t√© export√©s vers le SGIRO avec succ√®s.</p>
            <p>Identifiants des incidents cr√©√©s : 
                <span id="sgiroIncidents" style="font-weight: bold;"></span>
            </p>
        </div>
    </div>

    <footer class="footer">
        <p><strong>Fiche de Contr√¥le LCB-FT</strong></p>
        <p>Direction du Contr√¥le Permanent</p>
        
        <p>Con√ßu par: Par Mahdi Ben Jabeur</p>
    </footer>

    <script>
        // Donn√©es des points de contr√¥le
        const pointsControle = [
            { code: 'MON-01', libelle: 'KYC renforc√© √† la souscription carte premium', niveau: 'MAJEUR', statut: 'N/A' },
            { code: 'MON-02', libelle: 'Plafonds de retrait proportionnels au profil client', niveau: 'MAJEUR', statut: 'N/A' },
            { code: 'MON-03', libelle: 'Alertes automatiques retraits internationaux atypiques', niveau: 'CRITIQUE', statut: 'N/A' },
            { code: 'MON-04', libelle: 'Blocage imm√©diat apr√®s 3 tentatives √©chou√©es', niveau: 'CRITIQUE', statut: 'N/A' },
            { code: 'MON-05', libelle: 'Contr√¥le origine des fonds (porte-monnaie √©lectronique)', niveau: 'MAJEUR', statut: 'N/A' },
            { code: 'MON-06', libelle: 'Filtrage commer√ßants TPE vs listes de sanctions', niveau: 'MAJEUR', statut: 'N/A' },
            { code: 'MON-07', libelle: 'Analyse comportementale transactions carte (sc√©narios)', niveau: 'MAJEUR', statut: 'N/A' },
            { code: 'MON-08', libelle: 'Reporting mensuel op√©rations mon√©tique √† haut risque', niveau: 'MINEUR', statut: 'N/A' },
            { code: 'MON-09', libelle: 'Archivage 5 ans ‚Äì historique transactions carte', niveau: 'MINEUR', statut: 'N/A' },
            { code: 'MON-10', libelle: 'Proc√©dure de gestion fraude carte (d√©lais < 24h)', niveau: 'CRITIQUE', statut: 'N/A' }
        ];

        // Donn√©es du contr√¥le (en m√©moire)
        let controleLCBFT = {
            id: Date.now(),
            reference: '',
            dateControle: '',
            controleur: '',
            perimeter: [],
            entite: '',
            periodeControle: '',
            pointsControle: JSON.parse(JSON.stringify(pointsControle)),
            resultats: {
                conformes: 0,
                nonConformes: 0,
                ecartsMajeurs: 0,
                ecartsCritiques: 0,
                na: 0
            },
            analyseEcarts: {
                constats: '',
                causes: '',
                recommandations: '',
                planActions: ''
            },
            signatures: {
                controleur: { nom: '', date: '' },
                responsableEntite: { nom: '', date: '' },
                rclabc: { nom: '', date: '' }
            }
        };

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            // D√©finir la date du jour par d√©faut
            const today = new Date();
            const formattedDate = today.toISOString().split('T')[0];
            document.getElementById('dateControle').value = formattedDate;
            document.getElementById('dateControleur').value = formattedDate;
            document.getElementById('dateResponsable').value = formattedDate;
            document.getElementById('dateRCLABC').value = formattedDate;
            
            // G√©n√©rer les points de contr√¥le
            genererPointsControle();
            
            // Initialiser les √©v√©nements
            initialiserEvenements();
            
            // Initialiser les graphiques
            initialiserGraphiques();
            
            // Afficher les contr√¥les sauvegard√©s
            afficherControlesSauvegardes();
        });

        // G√©n√©rer les points de contr√¥le
        function genererPointsControle() {
            const tbody = document.querySelector('#tableauControle tbody');
            tbody.innerHTML = '';
            
            controleLCBFT.pointsControle.forEach(point => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>
                        <strong>${point.code}</strong> ‚Äì ${point.libelle}
                    </td>
                    <td>
                        <span class="status-badge status-${point.niveau.toLowerCase()}">
                            ${point.niveau}
                        </span>
                    </td>
                    <td>
                        <span id="statut-${point.code}" class="status-badge status-${point.statut.toLowerCase()}">
                            ${point.statut}
                        </span>
                    </td>
                    <td>
                        <select class="form-control" onchange="evaluerPoint('${point.code}', this.value)">
                            <option value="conforme" ${point.statut === 'Conforme' ? 'selected' : ''}>Conforme</option>
                            <option value="non_conforme" ${point.statut === 'Non Conforme' ? 'selected' : ''}>Non Conforme</option>
                            <option value="na" ${point.statut === 'N/A' ? 'selected' : ''}>N/A</option>
                        </select>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        // √âvaluer un point de contr√¥le
        function evaluerPoint(code, statut) {
            const point = controleLCBFT.pointsControle.find(p => p.code === code);
            if (point) {
                // Convertir les valeurs en format affich√©
                let affichageStatut;
                switch(statut) {
                    case 'conforme':
                        affichageStatut = 'Conforme';
                        break;
                    case 'non_conforme':
                        affichageStatut = 'Non Conforme';
                        break;
                    case 'na':
                        affichageStatut = 'N/A';
                        break;
                    default:
                        affichageStatut = statut;
                }
                
                point.statut = affichageStatut;
                
                // Mettre √† jour l'interface
                const statutElement = document.getElementById(`statut-${code}`);
                statutElement.className = `status-badge status-${statut}`;
                statutElement.textContent = affichageStatut;
                
                // Mettre √† jour les statistiques
                mettreAJourStatistiques();
            }
        }

        // Mettre √† jour les statistiques
        function mettreAJourStatistiques() {
            // R√©initialiser les compteurs
            controleLCBFT.resultats = {
                conformes: 0,
                nonConformes: 0,
                ecartsMajeurs: 0,
                ecartsCritiques: 0,
                na: 0
            };
            
            // Compter les statuts
            controleLCBFT.pointsControle.forEach(point => {
                switch(point.statut.toLowerCase()) {
                    case 'conforme':
                        controleLCBFT.resultats.conformes++;
                        break;
                    case 'non conforme':
                        controleLCBFT.resultats.nonConformes++;
                        break;
                    case 'n/a':
                        controleLCBFT.resultats.na++;
                        break;
                }
            });
            
            // Mettre √† jour l'interface
            document.getElementById('conformes').textContent = controleLCBFT.resultats.conformes;
            document.getElementById('ecartsMineurs').textContent = controleLCBFT.resultats.nonConformes;
            document.getElementById('ecartsMajeurs').textContent = controleLCBFT.resultats.ecartsMajeurs;
            document.getElementById('ecartsCritiques').textContent = controleLCBFT.resultats.ecartsCritiques;
            
            document.getElementById('conformesCount').value = controleLCBFT.resultats.conformes;
            document.getElementById('ecartsMineursCount').value = controleLCBFT.resultats.nonConformes;
            document.getElementById('ecartsMajeursCount').value = controleLCBFT.resultats.ecartsMajeurs;
            document.getElementById('ecartsCritiquesCount').value = controleLCBFT.resultats.ecartsCritiques;
            document.getElementById('naCount').value = controleLCBFT.resultats.na;
            
            // Mettre √† jour le statut de conformit√©
            mettreAJourStatutConformite();
            
            // Mettre √† jour les graphiques
            mettreAJourGraphiques();
        }

        // Mettre √† jour le statut de conformit√©
        function mettreAJourStatutConformite() {
            const objectifConformite = parseInt(document.getElementById('objectifConformite').value) || 95;
            const totalPoints = controleLCBFT.pointsControle.length;
            const conformes = controleLCBFT.resultats.conformes;
            const pourcentage = totalPoints > 0 ? Math.round((conformes / totalPoints) * 100) : 0;
            
            const statutElement = document.getElementById('statutConformite');
            
            if (pourcentage >= objectifConformite) {
                statutElement.className = 'status-badge status-conforme';
                statutElement.textContent = `‚úÖ Conforme (${pourcentage}%)`;
            } else if (pourcentage >= objectifConformite - 10) {
                statutElement.className = 'status-badge status-mineur';
                statutElement.textContent = `‚ö†Ô∏è √Ä am√©liorer (${pourcentage}%)`;
            } else if (pourcentage >= objectifConformite - 20) {
                statutElement.className = 'status-badge status-majeur';
                statutElement.textContent = `üî∂ √Ä traiter (${pourcentage}%)`;
            } else {
                statutElement.className = 'status-badge status-critique';
                statutElement.textContent = `üî¥ Urgent (${pourcentage}%)`;
            }
        }

        // Initialiser les √©v√©nements
        function initialiserEvenements() {
            // Sauvegarder
            document.getElementById('btnSauvegarder').addEventListener('click', sauvegarderControle);
            
            // Imprimer
            document.getElementById('btnImprimer').addEventListener('click', imprimerControle);
            
            // Exporter vers SGIRO
            document.getElementById('btnExportSGIRO').addEventListener('click', exporterVersSGIRO);
            
            // G√©n√©rer rapport
            document.getElementById('btnGenererRapport').addEventListener('click', genererRapportPDF);
            
            // G√©n√©rer statistiques
            document.getElementById('btnGenererStatistiques').addEventListener('click', mettreAJourStatistiques);
            
            // Mettre √† jour le statut de conformit√© lors du changement
            document.getElementById('objectifConformite').addEventListener('input', mettreAJourStatutConformite);
            
            // √âcouteurs pour les champs de signature
            document.getElementById('nomControleur').addEventListener('change', function() {
                controleLCBFT.signatures.controleur.nom = this.value;
            });
            
            document.getElementById('dateControleur').addEventListener('change', function() {
                controleLCBFT.signatures.controleur.date = this.value;
            });
            
            document.getElementById('nomResponsable').addEventListener('change', function() {
                controleLCBFT.signatures.responsableEntite.nom = this.value;
            });
            
            document.getElementById('dateResponsable').addEventListener('change', function() {
                controleLCBFT.signatures.responsableEntite.date = this.value;
            });
            
            document.getElementById('nomRCLABC').addEventListener('change', function() {
                controleLCBFT.signatures.rclabc.nom = this.value;
            });
            
            document.getElementById('dateRCLABC').addEventListener('change', function() {
                controleLCBFT.signatures.rclabc.date = this.value;
            });
            
            // R√©initialiser
            document.getElementById('btnReinitialiser').addEventListener('click', function() {
                if (confirm('Voulez-vous vraiment r√©initialiser tous les points de contr√¥le ?')) {
                    controleLCBFT.pointsControle.forEach(point => {
                        point.statut = 'N/A';
                    });
                    
                    // Mettre √† jour l'interface
                    genererPointsControle();
                    mettreAJourStatistiques();
                    
                    alert('Contr√¥le r√©initialis√© avec succ√®s !');
                }
            });
        }

        // Sauvegarder le contr√¥le
        function sauvegarderControle() {
            // R√©cup√©rer les donn√©es du formulaire
            controleLCBFT.reference = document.getElementById('reference').value;
            controleLCBFT.dateControle = document.getElementById('dateControle').value;
            controleLCBFT.controleur = document.getElementById('controleur').value;
            controleLCBFT.perimetre = Array.from(
                document.getElementById('perimetre').selectedOptions
            ).map(option => option.value);
            controleLCBFT.entite = document.getElementById('entite').value;
            controleLCBFT.periodeControle = document.getElementById('periodeControle').value;
            
            // Sauvegarder dans localStorage
            const sauvegardes = JSON.parse(localStorage.getItem('controlesLCBFT')) || [];
            const index = sauvegardes.findIndex(c => c.id === controleLCBFT.id);
            
            if (index === -1) {
                sauvegardes.push({ ...controleLCBFT });
            } else {
                sauvegardes[index] = { ...controleLCBFT };
            }
            
            localStorage.setItem('controlesLCBFT', JSON.stringify(sauvegardes));
            
            // Mettre √† jour les statistiques
            mettreAJourStatistiques();
            
            alert('Contr√¥le sauvegard√© avec succ√®s !');
            
            // Mettre √† jour la liste des contr√¥les sauvegard√©s
            afficherControlesSauvegardes();
        }

        // Imprimer le contr√¥le
        function imprimerControle() {
            window.print();
        }

        // Exporter vers SGIRO
        function exporterVersSGIRO() {
            // R√©cup√©rer les √©carts critiques et majeurs
            const ecartsCritiques = controleLCBFT.pointsControle.filter(point => 
                point.statut.toLowerCase() === 'non conforme');
            const ecartsMajeurs = controleLCBFT.pointsControle.filter(point => 
                point.statut.toLowerCase() === 'non conforme');
            
            if (ecartsCritiques.length === 0 && ecartsMajeurs.length === 0) {
                alert('Aucun √©cart critique ou majeur √† exporter vers SGIRO');
                return;
            }
            
            // G√©n√©rer les identifiants des incidents
            const incidentsIds = [];
            const currentDate = new Date().toISOString().split('T')[0];
            
            // Simuler l'export vers SGIRO
            setTimeout(() => {
                // Cr√©er des incidents pour les √©carts critiques
                ecartsCritiques.forEach(point => {
                    const incidentId = `LCBFT-${controleLCBFT.reference}-${point.code}`;
                    incidentsIds.push(incidentId);
                    
                    // Simuler l'envoi vers SGIRO
                    console.log(`Export vers SGIRO: ${incidentId}`);
                });
                
                // Cr√©er des incidents pour les √©carts majeurs
                ecartsMajeurs.forEach(point => {
                    const incidentId = `LCBFT-${controleLCBFT.reference}-${point.code}`;
                    incidentsIds.push(incidentId);
                    
                    // Simuler l'envoi vers SGIRO
                    console.log(`Export vers SGIRO: ${incidentId}`);
                });
                
                // Afficher la notification
                const notification = document.getElementById('sgiroNotification');
                const incidentsElement = document.getElementById('sgiroIncidents');
                
                incidentsElement.textContent = incidentsIds.join(', ');
                notification.classList.add('show');
                
                // Masquer la notification apr√®s 5 secondes
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 5000);
            }, 500);
        }

        // G√©n√©rer le rapport PDF
        function genererRapportPDF() {
            // R√©cup√©rer les donn√©es
            const controle = {
                ...controleLCBFT,
                reference: document.getElementById('reference').value,
                dateControle: document.getElementById('dateControle').value,
                controleur: document.getElementById('controleur').value,
                perimeter: Array.from(document.getElementById('perimetre').selectedOptions).map(opt => opt.text),
                entite: document.getElementById('entite').value,
                periodeControle: document.getElementById('periodeControle').value,
                constats: document.getElementById('constatsPrincipaux').value,
                causes: document.getElementById('causesRacines').value,
                recommandations: document.getElementById('recommandationsCorrectives').value,
                planActions: document.getElementById('planActions').value,
                signatures: {
                    controleur: {
                        nom: document.getElementById('nomControleur').value,
                        date: document.getElementById('dateControleur').value
                    },
                    responsableEntite: {
                        nom: document.getElementById('nomResponsable').value,
                        date: document.getElementById('dateResponsable').value
                    },
                    rclabc: {
                        nom: document.getElementById('nomRCLABC').value,
                        date: document.getElementById('dateRCLABC').value
                    }
                }
            };
            
            // G√©n√©rer le PDF
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Ajouter le logo (en r√©alit√©, on utiliserait une image)
            doc.setFontSize(18);
            doc.setFont('helvetica', 'bold');
            doc.text('Fiche de Contr√¥le LCB-FT', 105, 20, null, null, 'center');
            
            // Ajouter les informations g√©n√©rales
            doc.setFontSize(12);
            doc.setFont('helvetica', 'normal');
            doc.text('Contr√¥le Permanent ‚Äì Niveau 2 (Confidentiel)', 105, 28, null, null, 'center');
            
            // Ajouter les informations g√©n√©rales
            doc.setFontSize(10);
            doc.setFont('helvetica', 'bold');
            doc.text('INFORMATIONS G√âN√âRALES', 15, 40);
            
            doc.setFont('helvetica', 'normal');
            doc.text(`N¬∞ R√©f√©rence: ${controle.reference}`, 15, 50);
            doc.text(`Date du contr√¥le: ${controle.dateControle}`, 15, 55);
            doc.text(`Contr√¥leur: ${controle.controleur}`, 15, 60);
            doc.text(`P√©rim√®tre: ${controle.perimeter.join(', ')}`, 15, 65);
            doc.text(`Entit√©(s)/Agence(s): ${controle.entite}`, 15, 70);
            doc.text(`P√©riode contr√¥l√©e: ${controle.periodeControle}`, 15, 75);
            
            // Ajouter les points de contr√¥le
            doc.setFont('helvetica', 'bold');
            doc.text('POINTS DE CONTR√îLE', 15, 85);
            
            doc.setFont('helvetica', 'normal');
            let y = 95;
            
            controle.pointsControle.forEach(point => {
                const statut = point.statut;
                const statutColor = statut.includes('non conforme') ? '#e53e3e' : 
                                    statut.includes('majeur') ? '#ea580c' :
                                    statut.includes('mineur') ? '#d97706' : '#0d9488';
                
                doc.setTextColor(statutColor);
                doc.text(`${point.code} ‚Äì ${point.libelle} (${point.niveau})`, 15, y);
                doc.setTextColor(0, 0, 0);
                doc.text(`Statut: ${statut}`, 15, y + 5);
                y += 10;
                
                if (y > 250) {
                    doc.addPage();
                    y = 20;
                }
            });
            
            // Ajouter les r√©sultats
            doc.setFont('helvetica', 'bold');
            doc.text('R√âSULTATS', 15, y + 10);
            
            doc.setFont('helvetica', 'normal');
            y += 5;
            doc.text(`Conformes: ${controle.resultats.conformes}`, 15, y);
            doc.text(`Non Conformes: ${controle.resultats.nonConformes}`, 15, y + 5);
            doc.text(`√âcarts majeurs: ${controle.resultats.ecartsMajeurs}`, 15, y + 10);
            doc.text(`√âcarts critiques: ${controle.resultats.ecartsCritiques}`, 15, y + 15);
            doc.text(`N/A: ${controle.resultats.na}`, 15, y + 20);
            
            // Ajouter l'analyse des √©carts
            doc.setFont('helvetica', 'bold');
            doc.text('ANALYSE DES √âCARTS', 15, y + 30);
            
            doc.setFont('helvetica', 'normal');
            y += 35;
            doc.text('Constats principaux:', 15, y);
            doc.text(controle.constats || 'Aucun constat', 15, y + 5);
            
            y += 10;
            doc.text('Causes racines:', 15, y);
            doc.text(controle.causes || 'Aucune cause identifi√©e', 15, y + 5);
            
            y += 10;
            doc.text('Recommandations correctives:', 15, y);
            doc.text(controle.recommandations || 'Aucune recommandation', 15, y + 5);
            
            y += 10;
            doc.text('Plan d‚Äôactions:', 15, y);
            doc.text(controle.planActions || 'Aucun plan d‚Äôaction', 15, y + 5);
            
            // Ajouter les signatures
            doc.setFont('helvetica', 'bold');
            doc.text('SIGNATURES', 15, y + 25);
            
            doc.setFont('helvetica', 'normal');
            y += 25;
            doc.text(`Contr√¥leur: ${controle.signatures.controleur.nom}`, 15, y);
            doc.text(`Date: ${controle.signatures.controleur.date}`, 15, y + 5);
            
            y += 10;
            doc.text(`Responsable Entit√©: ${controle.signatures.responsableEntite.nom}`, 15, y);
            doc.text(`Date: ${controle.signatures.responsableEntite.date}`, 15, y + 5);
            
            y += 10;
            doc.text(`RCLABC: ${controle.signatures.rclabc.nom}`, 15, y);
            doc.text(`Date: ${controle.signatures.rclabc.date}`, 15, y + 5);
            
            // Ajouter la note de confidentialit√©
            doc.setFont('helvetica', 'italic');
            doc.text('Document confidentiel ‚Äì Archivage 10 ans (r√©f√©rentiel interne)', 105, 280, null, null, 'center');
            
            // Sauvegarder le PDF
            doc.save(`Rapport_LCBFT_${controle.reference}.pdf`);
        }

        // Initialiser les graphiques
        let chartResultats, chartCriticite;

        function initialiserGraphiques() {
            const ctxResultats = document.getElementById('chartResultats').getContext('2d');
            chartResultats = new Chart(ctxResultats, {
                type: 'doughnut',
                data: {
                    labels: ['Conformes', 'Non Conformes', 'N/A'],
                    datasets: [{
                        data: [0, 0, 0],
                        backgroundColor: ['#10b981', '#ef4444', '#6b7280']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        },
                        title: {
                            display: true,
                            text: 'R√©partition des R√©sultats'
                        }
                    }
                }
            });
            
            const ctxCriticite = document.getElementById('chartCriticite').getContext('2d');
            chartCriticite = new Chart(ctxCriticite, {
                type: 'bar',
                data: {
                    labels: ['Conformes', 'Non Conformes', 'N/A'],
                    datasets: [{
                        label: 'Nombre de points',
                        data: [0, 0, 0],
                        backgroundColor: [
                            'rgba(16, 185, 129, 0.8)',
                            'rgba(239, 68, 68, 0.8)',
                            'rgba(107, 114, 128, 0.8)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Nombre de points'
                            }
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'R√©partition par Niveau de Criticit√©'
                        }
                    }
                }
            });
        }

        // Mettre √† jour les graphiques
        function mettreAJourGraphiques() {
            chartResultats.data.datasets[0].data = [
                controleLCBFT.resultats.conformes,
                controleLCBFT.resultats.nonConformes,
                controleLCBFT.resultats.na
            ];
            chartResultats.update();
            
            chartCriticite.data.datasets[0].data = [
                controleLCBFT.resultats.conformes,
                controleLCBFT.resultats.nonConformes,
                controleLCBFT.resultats.na
            ];
            chartCriticite.update();
        }

        // Afficher les contr√¥les sauvegard√©s
        function afficherControlesSauvegardes() {
            const tbody = document.querySelector('#tableauControlesSauvegardes tbody');
            tbody.innerHTML = '';
            
            const sauvegardes = JSON.parse(localStorage.getItem('controlesLCBFT')) || [];
            
            if (sauvegardes.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="text-center">Aucun contr√¥le sauvegard√©</td></tr>';
                return;
            }
            
            // Appliquer le filtre
            const filtre = document.getElementById('filtreControles').value;
            const recherche = document.getElementById('rechercheControles').value.toLowerCase();
            
            const controlesFiltres = sauvegardes.filter(controle => {
                // Filtrer par conformit√©
                if (filtre !== 'all') {
                    const pourcentage = controle.pointsControle.length > 0 ? 
                        Math.round((controle.pointsControle.filter(p => p.statut === 'Conforme').length / controle.pointsControle.length) * 100) : 0;
                        
                    if (filtre === 'conforme' && pourcentage < 95) return false;
                    if (filtre === 'mineur' && pourcentage >= 85) return false;
                    if (filtre === 'majeur' && pourcentage >= 75) return false;
                    if (filtre === 'critique' && pourcentage >= 50) return false;
                }
                
                // Filtrer par recherche
                if (recherche && !controle.reference.toLowerCase().includes(recherche)) {
                    return false;
                }
                
                return true;
            });
            
            // Afficher les r√©sultats
            if (controlesFiltres.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="text-center">Aucun r√©sultat trouv√©</td></tr>';
                return;
            }
            
            controlesFiltres.forEach(controle => {
                const pourcentage = controle.pointsControle.length > 0 ? 
                    Math.round((controle.pointsControle.filter(p => p.statut === 'Conforme').length / controle.pointsControle.length) * 100) : 0;
                
                let statutClass = 'status-conforme';
                let statutText = 'Conforme';
                
                if (pourcentage < 95 && pourcentage >= 85) {
                    statutClass = 'status-mineur';
                    statutText = '√Ä am√©liorer';
                } else if (pourcentage < 85 && pourcentage >= 75) {
                    statutClass = 'status-majeur';
                    statutText = '√Ä traiter';
                } else if (pourcentage < 75) {
                    statutClass = 'status-critique';
                    statutText = 'Urgent';
                }
                
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${controle.reference}</td>
                    <td>${formaterDate(controle.dateControle)}</td>
                    <td>${controle.controleur}</td>
                    <td><span class="status-badge ${statutClass}">${statutText} (${pourcentage}%)</span></td>
                    <td>
                        <button class="btn btn-primary btn-modifier" onclick="modifierControle(${controle.id})">Modifier</button>
                        <button class="btn btn-danger btn-supprimer" onclick="supprimerControle(${controle.id})">Supprimer</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        // Modifier un contr√¥le sauvegard√©
        function modifierControle(id) {
            const sauvegardes = JSON.parse(localStorage.getItem('controlesLCBFT')) || [];
            const controle = sauvegardes.find(c => c.id === id);
            
            if (controle) {
                // Mettre √† jour le contr√¥le courant avec les donn√©es sauvegard√©es
                controleLCBFT = { ...controle };
                
                // Mettre √† jour l'interface
                document.getElementById('reference').value = controle.reference;
                document.getElementById('dateControle').value = controle.dateControle;
                document.getElementById('controleur').value = controle.controleur;
                
                // S√©lectionner les p√©rim√®tres
                const perimeterSelect = document.getElementById('perimetre');
                Array.from(perimeterSelect.options).forEach(option => {
                    option.selected = controle.perimetre.includes(option.value);
                });
                
                // Mettre √† jour l'entit√©
                document.getElementById('entite').value = controle.entite;
                
                document.getElementById('periodeControle').value = controle.periodeControle;
                
                // Mettre √† jour les points de contr√¥le
                controle.pointsControle.forEach(point => {
                    const index = pointsControle.findIndex(p => p.code === point.code);
                    if (index !== -1) {
                        pointsControle[index].statut = point.statut;
                    }
                });
                
                // Mettre √† jour les statistiques
                mettreAJourStatistiques();
                
                // Mettre √† jour les graphiques
                mettreAJourGraphiques();
                
                alert('Contr√¥le charg√© avec succ√®s !');
            }
        }

        // Supprimer un contr√¥le sauvegard√©
        function supprimerControle(id) {
            if (confirm('Voulez-vous vraiment supprimer ce contr√¥le ?')) {
                const sauvegardes = JSON.parse(localStorage.getItem('controlesLCBFT')) || [];
                const nouvellesSauvegardes = sauvegardes.filter(controle => controle.id !== id);
                localStorage.setItem('controlesLCBFT', JSON.stringify(nouvellesSauvegardes));
                
                afficherControlesSauvegardes();
                alert('Contr√¥le supprim√© avec succ√®s !');
            }
        }

        // Formater une date
        function formaterDate(dateString) {
            if (!dateString) return '';
            const date = new Date(dateString);
            return date.toLocaleDateString('fr-FR');
        }

        // V√©rifier si une fiche est sauvegard√©e
        if (localStorage.getItem('controlesLCBFT')) {
            afficherControlesSauvegardes();
        }
    </script>
</body>
</html>
